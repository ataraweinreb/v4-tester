import React, { useEffect } from 'react';

const ParticleAsciiArt = () => {
  useEffect(() => {
    const canvas = document.getElementById('particleCanvas');
    const ctx = canvas.getContext('2d');
    const particles = [];
    const mouse = { x: null, y: null };

    const asciiArt = `                                                                                                                                                   

                                                                                                                                                      ..            ....................................                                                                                                                                                      

                                                                                                                                                     ...       ............                    ............                                                                                                                                                   

                                                                                                                                                   ..         ......                                ...........                                                                                                                                               

                                                                                                                                               .........                                                ..........                                                                                                                                            

                                                                                                                                          ..............                                                   ...........                                                                                                                                        

                                                                                                                                       ..........                                                              ..........                                                                                                                                     

                                                                                                                                    .........                                                                     ..........                                                                                                                                  

                                                                                                                                  ........                                    ...................                    ..........                                                                                                                               

                                                                                                                                .......                                   ........           ........                   ..........                                                                                                                            

                                                                                                                              .......                                    ....                      .....                  ..........                                                                                                                          

                                                                                                                            ........                                     ..                            ....                  .........                                                                                                                        

                                                                                                                          ........                                                                        ...                  .........                                                                                                                      

                                                                                                                         .......                                                                             ...                  ........                                                                                                                    

                                                                                                                       .......                                                                                 ..                   ........                                                                                                                  

                                                                                                                      ......                                             .. ........                             ..                    ......                                                                                                                 

                                                                                                                     ......                                     ..............................                     ..                   .......                                                                                                               

                                                                                                                    ......                                   .........................................               ...                  ......                                                                                                              

                                                                                                                   ......                                 ................................................              ...                ......                                                                                                             

                                                                                                                   .....                               .......................................................             ..               ......                                                                                                            

                                                                                                                  ......                             ...........................................................                             ......                                                                                                           

                                                                                                                 ......                            ..............................................................                             ......                                                                                                          

                                                                                                                 .....                            ................................................................                             .....                                                                                                          

                                                                                                                ......                         ....................................................................                            ......                                                                                                         

                                                                                                                .....                         .....................................................................                             ......                                                                                                        

                                                                                                                .....                        ......................................................................                              .....                                                                                                        

                                                                                                               .....                        ........................................................................                             ......                                                                                                       

                                                                                                               .....                        ........................................................................                              .....                                                                                                       

                                                                                                              .....                         .........................................................................                             ......                                                                                                      

                                                                                                              .....                         ..........................................................................                             ......                                                                                                     

                                                                                                             .....                         ............................................................................                            ......                                                                                                     

                                                                                                            ......                         .............................................................................                            ......                                                                                                    

                                                                                                            .....                          ..............................................................................                            .....                                                                                                    

                                                                                                           ......                          ...............................................................................                           ......                                                                                                   

                                                                                                           .....                          ..........................................................            ...........                           .....                                                                                                   

                                                                                                          .....                           ............                    ......................                       ....                           ......                                                                                                  

                                                                                                         ......                          .........                          ....................                                                       .....                                                                                                  

                                                                                                        ......                          ........      ..........            ....................         ..............                                .....                                                                                                  

                                                                                                       ......                          .......    ................ ...........................      ......................                             ......                                                                                                 

                                                                                                      ......                           ...... ..........               ......................      ...                .....                             .....                                                                                                 

                                                                                                     ......                           ..............             .       ....................   ...       .       .       .                             .....                                                                                                 

                                                                                                   ......                            .............       ...     ..       ..................  ....                                                      .....                                                                                                 

                                                                                                  ......                             ............                ..    ............................                                                      .....                                                                                                

                                                                                                 ......                              .............         ...... ..    .............................    ......             ..                           .....                                                                                                

                                                                                                ......                              ............................        ..............................        ... .............                          .....                                                                                                

                                                                                              ......                                ...........................................................................................                          ......                                                                                               

                                                                                             ......                                 ...........................................................................................                           .....                                                                                               

                                                                                            ......                                 ............................................................................................                           ......                                                                                              

                                                                                          .......                                  .............................................................................................                           .....                                                                                              

                                                                                         ......                                    ..............................................................................................                          ......                                                                                             

                                                                                       .......                                     .............................................................................................                            .....                                                                                             

                                                                                      .......                                      ..............................................................................................                           ......                                                                                            

                                                                                     .......                                       ..............................................................................................                            .....                                                                                            

                                                                                   ........                                        .................................................................. .........................                              .....                                                                                            

                                                                                  .........                                         ..........................................   ..........           .........................                              ......                                                                                           

                                                                                 .........                                          .......................................         .....            ..........................                               .....                                                                                           

                                                                                 ...... .                                           ........................... ..................                 .........................                                  ......                                                                                          

                                                                                ......                                              .........................    ....................            ............   ...........                                    ......                                                                                         

                                                                               ......                                                ......................     ....................... .....................      .....                                        .....                                                                                         

                                                                              ......                                               . ....................    ..............................................          ..                                         ......                                                                                        

                                                                             ......                                             .. .....................   ................................       ..........     .  .........                                    ......                                                                                       

                                                                            ......                                                 .. .................. ...   ..........            ..                         ............                                      ......                                                                                      

                                                                            ......                                                    ......................                                                    ............                                       ......                                                                                     

                                                                           ......                                                      .......................        . ......................... ...          ............                                         ......                                                                                    

                                                                           .....                                                        ........................      ...............................         .............                                          ......                                                                                   

                                                                          ......                                                        ...........................      ........................  .       ...............                                            ......                                                                                  

                                                                         ......                                                          .............................. .  ..  ......  ...                 ..............                                              ......                                                                                 

                                                                         ......                                   .                       ...........................................   .. .........      ..............                                                ......                                                                                

                                                                        ......                                 ..                          ........................... ...........................       ..............                                                  .......                                                                              

                                                                       ......                                 .                              ...........................     ..................          .............                                                    .......                                                                             

                                                                       .....                                ..                                .............................        ......               ............                                                        ......                                                                            

                                                                      ......                               ..                                   ................................                     ..............                                                          ......                                                                           

                                                                      .....                               ..                                      .................................             .................                                                             ......                                                                          

                                                                     ......                              ..                                        ............................................................                                                                ......                                                                         

                                                                     .....                              ..                                            ......................................................                                                                    .......                                                                       

                                                                     .....                             ..                                                .................................................                                                                        ......                                                                      

                                                                     .....                             .                                                    ............................................                                                                       .   ......                                                                     

                                                                     .....                            ..                                                        ......................................                                                                         ..   ......                                                                    

                                                                    ......                            ..                                             ....            ..............................                                                                              .   .....                                                                    

                                                                    .....                             ..                       ...                  ...........          ....................                                                                                      . ......                                                                   

                                                                    .....                             .                      ........               ...............                                                                                                                 .......                                                                   

                                                                   ......                            ..                     ..........              .......................                                                                                                           ......                                                                  

                                                                   .....                            ...                      ........               ............................                                                                                                      ......                                                                  

                                                                  ......                           ...                         ....                 ................................                                                                                                  ......                                                                  

                                                                 ......    ....                   ...                                             .....................................                                                                                                .....                                                                  

                                                                ......    ....                   ...                                              ......................................                                                                                               ......                                                                 

                                                               ......                          ....                                              .......................................                                                                                               ......                                                                 

                                                              ......                          ....                                               ......................................                                                                                                ......                                                                 

                                                             ......                          ...                                                .........................................       .....                                                                                   .....                                                                 

                                                             ......                         ...                                                .......................................................                                                                                  ......                                                                

                                                             ..... .                       ....                                               .........................................................                                                                                  .....                                                                

                                                            ......                         ...                                               ...........................................................                                                                                 ......                                                               

                                                            ......                        ....                                              .............................................................                                                                              .  ......                                                              

                                                            .....                          ...                                             ..............................................................                                                                              ...........                                                            

                                                            .....                          ...                                             ..............................................................                                                                               ...........                                                           

                                                           .......                         ...                                           .................................................................                                                                                 .........                                                          

                                                         .. ......                         ..                                           ...................................................................                                                                                   .......                                                         

                                                        ..  ......                         ..                                          ....................................................................                                                                                    ......                                                         

                                                       ..   ......                         ..                                         ....................................................................................                                                                      ......                                                        

                                                      ...  .......                                                                   ........................................................................................                                                                    ......                                                       

                                                      ..   .......                                                                 .............................................................................................         .                                                        ......                                                      

                                                      .      .....                                                               ..................................................................................................    ......                                                      .......                                                    

                                                              .....  ....                                                    ....................................................................................................          .......                                                  .......                                                   

                                                             ........                           .....................       ....  .............................................................................................                    .........                                         ......                                                   

                                                      .............                       .........................                 .........................................................................................                                                                          ..                                                     

                                                      .......             ...................            ........                       ...................................................................................                                                                                                                                   

                                                       ........     ....................                                                   ................................................................................                                                                            ....                                                   

                                                          ...............     ....                                                            ...................................................................................                                                                     .....                                                   

                                                            .......                                                                        ..............................................................................................      ...                                                    ....                                                    

                                                               ....                                                                  ..........................................................................        ..............................          ..........                                                                                     

                                                                  ..                         .......                       .............................   ................................................                          ................................................                                                                         

                                                                                         ...............         ..............................                 .....................................                                               ................         ........................                                                         

                                            ..                                       ..................... .........................                                    .....................                                                            .....                       .................                                                        

                                           ......                     ......................          .... ...........                                                                                                                                                                       ........             ...                                         

                                          ...........                 ...................                                                                                                                                                                                                                       ......                                        

                                          ...............             ................                                                                                                                                                                                                                     ............                                       

                                            ................                                                                                                                                       .................       ..........                                                                  .................                                      

                                                ................                                                                                             .........................................................................................                 ........                     ................... .                                     

                                                     ...............                          ...                                      ...................................................................................................................        ..................               .............                                              

                                                         ..............                     ..........                 ....................................................................                  .............           ....................................................          ........                                                   

                                                             ...........                  ..................   ....................................................                                                                                    ..................      ................   ....                                                        

                                                                 .......               ......      ......................................                                                                                                                   .......              .................                            .                               

                                                                                                                                                                     .................................                                   .                                               ...
    `;

    const colorThemes = [
      () => `hsl(${Math.random() * 360}, 100%, 50%)`, // Rainbow (default)
      () => ['#FF0000', '#FFFFFF', '#0000FF'][Math.floor(Math.random() * 3)], // Red, White, and Blue
      () => `hsl(${Math.random() * 30 + 330}, 100%, ${Math.random() * 50 + 50}%)`, // Shades of Pink
      () => `hsl(${Math.random() * 240 + 180}, 100%, ${Math.random() * 50 + 50}%)`, // Shades of Blue
      () => `hsl(${Math.random() * 120}, 100%, ${Math.random() * 50 + 50}%)`, // Shades of Green
      () => `hsl(${Math.random() * 60 + 270}, 100%, ${Math.random() * 50 + 50}%)`, // Shades of Purple
      () => ['#FF4500', '#FF6347', '#FFD700'][Math.floor(Math.random() * 3)], // Sunset (Orange, Red, Yellow)
    ];
    let currentThemeIndex = 0;

    function resizeCanvas() {
      // phone
      if (window.innerWidth <= 768) {
        canvas.width = Math.min(window.innerWidth - 100);
      } else if (window.innerWidth <= 1200) {
        canvas.width = Math.min(390, window.innerWidth / 2 - 200);
      } else {
        canvas.width = Math.min(550, window.innerWidth); // Set width to 400px or screen width
      }

      canvas.height = canvas.width + 100; // Keep canvas square
      createParticlesFromAscii();
      animate();
    }

    function createParticlesFromAscii() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      const fontSize = Math.min(canvas.width / 260, canvas.height / 260); // Adjust font size based on canvas size
      const lineHeight = fontSize * 1; // Set line height slightly larger than font size
      ctx.font = `${fontSize}px Arial`;
      ctx.fillStyle = 'white';
      ctx.textAlign = 'left';
      ctx.textBaseline = 'top';

      const lines = asciiArt.split('\n');
      const maxLineLength = Math.max(...lines.map(line => line.length));
      const textWidth = maxLineLength * fontSize;
      const textHeight = lines.length * lineHeight;

      const offsetX = (canvas.width - textWidth) / 2;
      const offsetY = (canvas.height - textHeight) / 2;

      particles.length = 0;

      lines.forEach((line, y) => {
        for (let x = 0; x < line.length; x++) {
          if (line[x] !== ' ') {
            particles.push(
              new Particle(
                offsetX + x * fontSize,
                offsetY + y * lineHeight, // Adjust vertical position based on line height
                'white',
              ),
            );
          }
        }
      });
    }

    class Particle {
      constructor(x, y, color) {
        this.x = x;
        this.y = y;
        this.baseX = x;
        this.baseY = y;
        this.size = 2;
        this.color = color;
        this.velocityX = Math.random() * 2 - 1;
        this.velocityY = Math.random() * 2 - 1;
      }

      draw() {
        ctx.fillStyle = this.color;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.closePath();
        ctx.fill();
      }

      update() {
        let dx = mouse.x - this.x;
        let dy = mouse.y - this.y;
        let distance = Math.sqrt(dx * dx + dy * dy);
        let forceDirectionX = dx / distance;
        let forceDirectionY = dy / distance;
        let force = (150 - distance) / 150;
        let directionX = forceDirectionX * force * 15;
        let directionY = forceDirectionY * force * 15;

        if (distance < 150) {
          this.x -= directionX;
          this.y -= directionY;
          this.x += this.velocityX * 2;
          this.y += this.velocityY * 2;
        } else {
          if (this.x !== this.baseX) {
            let dx = this.x - this.baseX;
            this.x -= dx / 10;
          }
          if (this.y !== this.baseY) {
            let dy = this.y - this.baseY;
            this.y -= dy / 10;
          }
        }

        if (this.x < 0 || this.x > canvas.width) this.velocityX = -this.velocityX;
        if (this.y < 0 || this.y > canvas.height) this.velocityY = -this.velocityY;
      }
    }

    function animate() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.beginPath(); // Start drawing path
      particles.forEach(particle => {
        ctx.moveTo(particle.x, particle.y);
        particle.draw();
        particle.update();
      });
      ctx.closePath(); // End drawing path
      requestAnimationFrame(animate);
    }

    function changeColors() {
      currentThemeIndex = (currentThemeIndex + 1) % colorThemes.length;
      particles.forEach(particle => {
        particle.color = colorThemes[currentThemeIndex]();
      });
    }

    setInterval(changeColors, 800); // Change colors every 0.5 seconds

    let resizeTimeout;
    window.addEventListener('resize', () => {
      clearTimeout(resizeTimeout);
      resizeTimeout = setTimeout(resizeCanvas, 150);
    });

    let lastMouseMove = 0;
    window.addEventListener('mousemove', event => {
      const now = Date.now();
      if (now - lastMouseMove > 30) {
        // throttle to 30ms intervals
        mouse.x = event.x - canvas.getBoundingClientRect().left;
        mouse.y = event.y - canvas.getBoundingClientRect().top;
        lastMouseMove = now;
      }
    });

    resizeCanvas();
  }, []);

  return (
    <div style={{ position: 'relative', width: '100%', height: '100%' }}>
      <canvas id="particleCanvas"></canvas>
    </div>
  );
};

export default ParticleAsciiArt;
